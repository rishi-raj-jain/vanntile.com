---
import { getCollection } from 'astro:content'
import AnimatedHeader from '../components/AnimatedHeader.astro'
import ContactForm from '../components/ContactForm.astro'
import Experience from '../components/Experience.astro'
import SectionDivider from '../components/SectionDivider.astro'
import Tags from '../components/Tags.astro'
import BaseLayout from '../layouts/BaseLayout.astro'
import svg from '../lib/svgPaths.json'
import { READABLE_FORMAT, blogCompareFn, socialMedia } from '../lib/utils'

const props = {
  title: 'vanntile - frontend developer and graphic designer',
  publishedAt: new Date(),
  summary:
    'Developer by choice and designer for fun. I speak the languages of both engineering and aesthetics and ' +
    'can help with your next project.',
  image: 'banner.png',
  imageAlt: 'Banner image with logo and "Good design is invisible" motto',
  keywords: ['vanntile', 'portfolio', 'developer', 'graphic designer'],
}

const latestPosts = (await getCollection('blog')).sort(blogCompareFn).slice(0, 3)
---

<script>
  const options = {
    root: null,
    rootMargin: '0px',
    threshold: 0.4,
  }

  const setObserver = (target: Element | null, element: Element | null) => {
    if (!target || !element) return

    const callback: IntersectionObserverCallback = (entries, observer) => {
      if (entries[0].intersectionRatio > 0.4) element.classList.add('active')
      else element.classList.remove('active')
    }

    const observer = new IntersectionObserver(callback, options)
    observer.observe(target)
  }

  window.addEventListener('DOMContentLoaded', (_event) => {
    setObserver(document.querySelector('#section-tech'), document.querySelector('#logoSvg'))
    setObserver(document.querySelector('#section-experience'), document.querySelector('#logotypeSvg'))
  })
</script>

<BaseLayout frontmatter={props} withNav={false}>
  <main class="mx-auto w-full max-w-prose pb-32 pt-8 xl:px-6 xl:text-lg 2xl:max-w-6xl 2xl:text-xl">
    <section class="hSection flex min-h-screen flex-col justify-center px-6 py-16 text-left">
      <div>
        <header class="mb-16">
          <AnimatedHeader />
          <div class="text-xl font-semibold md:text-3xl">developer by choice and designer for fun</div>
        </header>
        <a class="sr-only" href="#section-tech">Skip to main content</a>
        <p class="md:text-lg 2xl:text-2xl">
          Are you searching for a practical enthusiast for your <span class="highlight">project</span>?
        </p>
        <p class="max-w-2xl md:text-lg 2xl:max-w-5xl 2xl:text-2xl">
          I speak the languages of both <span class="highlight">engineering and aesthetics</span>, being
          <br class="hidden md:inline-block 2xl:hidden" /> perfectly positioned to formulate the path of a feasible product
          with customer experience in mind. My preferred work is{' '}
          <span class="highlight">fullstack development</span>. I&apos;m using the best tool for the job, be it a
          reliable framework or the latest web features.
        </p>
        <p class="max-w-2xl md:text-lg 2xl:max-w-5xl 2xl:text-2xl">
          Neither impressive interfaces nor blazing performance are the solution, but the{' '}
          <span class="highlight">balance</span> between a maintainable implementation and
          <br class="hidden md:inline-block 2xl:hidden" /> user-focused functionality.
        </p>
        <div class="mt-8 flex flex-row flex-wrap gap-x-2">
          <a class="cta" href="#section-tech">techstack</a>
          <a class="cta" href="#section-experience">experience</a>
          <a class="cta" href="#section-blog">blog</a>
          <a class="cta" href="#section-design">design</a>
          <a class="cta" href="#section-contact">contact</a>
        </div>
      </div>
      <SectionDivider color="text-brand-accent" />
    </section>
    <section id="section-tech" class="hSection bg-brand-accent pb-24 pt-12 font-bold text-gray-800">
      <div class="-my-12 flex w-full flex-col items-center justify-center">
        <svg
          id="logoSvg"
          aria-hidden="true"
          focusable="false"
          class="active"
          width="210"
          height="210"
          viewBox="0 0 500 500"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d={svg.logomark}
            class="logoSvg stroke-current text-gray-900 will-change-transform"></path>
        </svg>
      </div>
      <h2 class="text-gray-900 dark:text-gray-900">./about/tech</h2>
      <p>
        I am an in-progress computer engineer with a deep passion for the worlds of frontend, design and deployment.
        Keep scrolling if you wanna know why, how and what I work on!
      </p>
      <h3>What is my tech stack?</h3>
      <span class="block font-bold">Languages</span>
      <Tags
        tags={['JavaScript (ES2021)', 'TypeScript', 'Go 🇬', 'Python 3 🐍', 'C/C++', 'Haskell λ']}
        class="bg-gray-800 text-brand-accent"
      />
      <span class="block font-bold">Markup</span>
      <Tags tags={['JSON', 'YAML', 'HTML', 'Markdown', 'MDX']} class="bg-gray-800 text-brand-accent" />
      <span class="block font-bold">Frameworks</span>
      <Tags
        tags={[
          'Astro 🚀',
          'NextJS 🇳',
          'React ⚛️',
          'Vue 🇻',
          'Angular 🛡️',
          'Tailwind CSS 🍃',
          'FastAPI ⚡',
          'Express',
          'Django',
          'Flask',
          'GTK/gtkmm',
          'unified',
        ]}
        class="bg-gray-800 text-brand-accent"
      />
      <span class="block font-bold">Testing</span>
      <Tags tags={['Robot 🤖', 'Cypress', 'Jest 🃏', 'JUnit']} class="bg-gray-800 text-brand-accent" />
      <span class="block font-bold">Tools</span>
      <Tags
        tags={['Deno 🦕', 'NodeJS 🟩', 'npm 📦', 'Docker 🐳', 'Jenkins 🎩']}
        class="bg-gray-800 text-brand-accent"
      />
      <span class="block font-bold">Platforms</span>
      <Tags
        tags={['GitHub 🐙', 'GitLab 🦊', 'Bitbucket 🪣', 'Heroku', 'Linode', 'Mastodon 🐘']}
        class="bg-gray-800 text-brand-accent"
      />
      <span class="block font-bold">Standards &amp; paradigms</span>
      <Tags
        tags={['FOSS', 'OpenAPI', 'REST', 'GraphQL', 'semantic web', 'functional programming']}
        class="bg-gray-800 text-brand-accent"
      />
      <span class="block font-bold">Design tools &amp; knowledge</span>
      <Tags
        tags={['Inkscape', 'Figma', 'GIMP', 'SVG', 'Typography', 'Layout', 'Visual idenitities']}
        class="bg-gray-800 text-brand-accent"
      />
      <span class="block font-bold">Other snappy stuff</span>
      <Tags
        tags={['git', 'Linux', 'GNOME', 'Obsidian', 'VSCodium', 'vim', 'Jupyter', 'Prettier']}
        class="bg-gray-800 text-brand-accent"
      />
      <SectionDivider color="text-brand" />
    </section>
    <section id="section-experience" class="hSection bg-brand pb-24 text-gray-100">
      <div class="mt-12 flex w-full flex-col items-center justify-center">
        <svg
          id="logotypeSvg"
          aria-hidden="true"
          focusable="false"
          class="active"
          width="520"
          height="60"
          viewBox="480 0 800 168"
          preserveAspectRatio="xMidYMid meet"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d={svg.logotype}
            fill="currentColor"
            class="logoSvg logotypeSvg stroke-current text-gray-100 will-change-transform"></path>
        </svg>
      </div>
      <h2 class="text-gray-100 dark:text-gray-100">./about/experience</h2>
      <Experience />
      <SectionDivider color="text-white dark:text-gray-900" />
    </section>
    <section class="hSection my-16">
      <h2 id="section-blog">./blog/coding/latest</h2>
      <div>
        {
          latestPosts.map((post) => (
            <div class="py-4">
              <p class="my-0">
                <time datetime={post.data.publishedAt.toISOString().slice(0, 10)}>
                  {READABLE_FORMAT.format(post.data.publishedAt)}
                </time>
              </p>
              <a href={`/blog/${post.slug}`}>{post.data.title}</a>
              <p class="my-1">{post.data.summary}</p>
            </div>
          ))
        }
      </div>
      <div class="my-6">
        <span class="pr-4 md:text-xl">...or</span>
        <a class="cta" href="/blog">Check all blog posts</a>
      </div>
    </section>
    <section class="hSection mb-24">
      <h2 id="section-design">./blog/design</h2>
      <a href="/design/brand-book">
        <div class="group relative cursor-pointer bg-brand md:-mx-6">
          <div
            class="scale-100 blur-none transition-transform group-hover:scale-90 group-hover:mix-blend-lighten group-hover:blur-sm"
          >
            <img loading="lazy" src="/assets/deck/page.1.webp" alt="vanntile brand deck cover page" />
          </div>
          <div class="absolute left-0 top-0 grid h-full w-full items-center justify-center">
            <h3
              class="my-0 border-l-8 border-brand-accent pl-4 pt-2 text-2xl text-gray-100 opacity-0 group-hover:opacity-100 md:text-5xl"
            >
              Brand book
            </h3>
          </div>
        </div>
      </a>
    </section>
    <section class="hSection mb-24">
      <h2 id="section-contact">./public/contact</h2>
      <p>You can find me here and there. I recommend you message me 📨 on Mastodon.</p>
      <div class="mb-8 flex flex-row flex-wrap gap-x-4 md:gap-x-8">
        {
          socialMedia.map((e) => (
            <a
              href={e.href}
              target="_blank"
              rel="me"
              referrerpolicy="same-origin"
              title={e.name}
              class="rotateScaleUp pseudo-none h-12 w-12 rounded-full bg-transparent ring-brand-accent will-change-transform focus:outline-none focus:ring-8 dark:bg-gray-900"
            >
              <svg
                aria-hidden="true"
                focusable="false"
                width="48"
                height="48"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d={e.d} fill="currentColor" class="text-gray-900 dark:text-gray-100" />
              </svg>
            </a>
          ))
        }
      </div>
      <ContactForm />
    </section>
  </main>
</BaseLayout>
